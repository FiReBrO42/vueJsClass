import{_,o as i,c as u,d as t,F as h,f as g,g as b,t as l,b as m,h as v,v as $}from"./index-755c0eb7.js";const{VITE_APP_URL:n,VITE_APP_PATH:d}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"firebro42",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},C={data(){return{productId:"",products:[],cart:[],loadingItem:"",form:{user:{name:"test",email:"test@gmail.com",tel:"0912346768",address:"kaohsiung"},message:"這是留言"}}},methods:{getProducts(){this.$http.get(`${n}/v2/api/${d}/products/all`).then(e=>{this.products=e.data.products})},openModal(e){this.productId=e},getCarts(){this.$http.get(`${n}/v2/api/${d}/cart`).then(e=>{this.cart=e.data.data})},updateCartItem(e){const o={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${n}/v2/api/${d}/cart/${e.id}`,{data:o}).then(p=>{this.getCarts(),this.loadingItem=""})},deleteCart(e){this.loadingItem=e.id,this.$http.delete(`${n}/v2/api/${d}/cart/${e.id}`).then(o=>{this.getCarts(),this.loadingItem=""})},deleteAllCart(){this.$http.delete(`${n}/v2/api/${d}/carts`).then(e=>{console.log("刪除全部購物車",e.data),this.getCarts()})},checkout(){const e=this.form;this.$http.post(`${n}/v2/api/${d}/order`,{data:e}).then(o=>{console.log("結帳",o.data)})}},mounted(){this.getProducts(),this.getCarts()}},f=t("div",null,"購物車",-1),x={class:"text-end"},I={class:"table align-middle"},P=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),y=["disabled","onClick"],V=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),k={class:"input-group input-group-sm"},A={class:"input-group mb-3"},E=["onUpdate:modelValue","disabled","onChange"],T={class:"input-group-text",id:"basic-addon2"},D={class:"text-end"},U=t("td",{colspan:"3",class:"text-end"},"總計",-1),q={class:"text-end"},B=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),L={class:"text-end text-success"};function R(e,o,p,w,a,r){return i(),u(h,null,[f,t("div",x,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=s=>r.deleteAllCart())}," 清空購物車 ")]),t("table",I,[P,t("tbody",null,[a.cart.carts?(i(!0),u(h,{key:0},g(a.cart.carts,s=>(i(),u("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===a.loadingItem,onClick:c=>r.deleteCart(s)},[V,m(" x ")],8,y)]),t("td",null,l(s.product.title)+" ",1),t("td",null,[t("div",k,[t("div",A,[v(t("input",{type:"number",class:"form-control",min:"1",oninput:"this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\\..*)\\./g, '$1');","onUpdate:modelValue":c=>s.qty=c,disabled:s.id===a.loadingItem,onChange:c=>r.updateCartItem(s)},null,40,E),[[$,s.qty]]),t("span",T,l(s.product.unit),1)])])]),t("td",D,l(s.total),1)]))),128)):b("",!0)]),t("tfoot",null,[t("tr",null,[U,t("td",q,l(a.cart.total),1)]),t("tr",null,[B,t("td",L,l(a.cart.final_total),1)])])])],64)}const N=_(C,[["render",R]]);export{N as default};
