import{_ as C,r as h,o as _,c as f,d as e,F as b,f as y,g as I,t as c,a as n,w as P,h as k,b as E,i as v,v as g,n as p}from"./index-c0e2a19a.js";const{VITE_APP_URL:d,VITE_APP_PATH:r}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"firebro42",BASE_URL:"/vueJsClass/week6/dist/",MODE:"production",DEV:!1,PROD:!0},U={data(){return{productId:"",products:[],cart:[],loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getProducts(){this.$http.get(`${d}/v2/api/${r}/products/all`).then(t=>{this.products=t.data.products})},openModal(t){this.productId=t},getCarts(){this.$http.get(`${d}/v2/api/${r}/cart`).then(t=>{this.cart=t.data.data})},updateCartItem(t){const s={product_id:t.product.id,qty:t.qty};this.loadingItem=t.id,this.$http.put(`${d}/v2/api/${r}/cart/${t.id}`,{data:s}).then(V=>{this.getCarts(),this.loadingItem=""})},deleteCart(t){this.loadingItem=t.id,this.$http.delete(`${d}/v2/api/${r}/cart/${t.id}`).then(s=>{this.getCarts(),this.loadingItem=""})},deleteAllCart(){this.$http.delete(`${d}/v2/api/${r}/carts`).then(t=>{console.log("刪除全部購物車",t.data),this.getCarts()})},checkout(){const t=this.form;this.$http.post(`${d}/v2/api/${r}/order`,{data:t}).then(s=>{console.log("結帳",s.data)})},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"需要正確的電話號碼"}},mounted(){this.getProducts(),this.getCarts()}},w=e("div",null,"購物車",-1),A={class:"text-end"},T={class:"table align-middle"},$=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),q=["disabled","onClick"],N=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),D={class:"input-group input-group-sm"},B={class:"input-group mb-3"},L=["onUpdate:modelValue","disabled","onChange"],M={class:"input-group-text",id:"basic-addon2"},R={class:"text-end"},S=e("td",{colspan:"3",class:"text-end"},"總計",-1),F={class:"text-end"},H=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),O={class:"text-end text-success"},j={class:"my-5 row justify-content-center"},z={class:"mb-3"},J=e("label",{for:"email",class:"form-label"},"Email",-1),G={class:"mb-3"},K=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),Q={class:"mb-3"},W=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),X={class:"mb-3"},Y=e("label",{for:"address",class:"form-label"},"收件人地址",-1),Z={class:"mb-3"},ee=e("label",{for:"message",class:"form-l abel"},"留言",-1),te=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function se(t,s,V,le,o,i){const u=h("v-field"),m=h("error-message"),x=h("v-form");return _(),f(b,null,[w,e("div",A,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:s[0]||(s[0]=l=>i.deleteAllCart())}," 清空購物車 ")]),e("table",T,[$,e("tbody",null,[o.cart.carts?(_(!0),f(b,{key:0},y(o.cart.carts,l=>(_(),f("tr",{key:l.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:l.id===o.loadingItem,onClick:a=>i.deleteCart(l)},[N,E(" x ")],8,q)]),e("td",null,c(l.product.title)+" ",1),e("td",null,[e("div",D,[e("div",B,[v(e("input",{type:"number",class:"form-control",min:"1",oninput:"this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\\..*)\\./g, '$1');","onUpdate:modelValue":a=>l.qty=a,disabled:l.id===o.loadingItem,onChange:a=>i.updateCartItem(l)},null,40,L),[[g,l.qty]]),e("span",M,c(l.product.unit),1)])])]),e("td",R,c(l.total),1)]))),128)):I("",!0)]),e("tfoot",null,[e("tr",null,[S,e("td",F,c(o.cart.total),1)]),e("tr",null,[H,e("td",O,c(o.cart.final_total),1)])])]),e("div",j,[n(x,{ref:"form",class:"col-md-6",onSubmit:s[6]||(s[6]=k(l=>i.checkout(),["prevent"]))},{default:P(({errors:l})=>[e("div",z,[J,n(u,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":l.email,"is-valid":!l.email&&o.form.user.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:o.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=a=>o.form.user.email=a)},null,8,["class","modelValue"]),n(m,{name:"email",class:"invalid-feedback"})]),e("div",G,[K,n(u,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=a=>o.form.user.name=a)},null,8,["class","modelValue"]),n(m,{name:"姓名",class:"invalid-feedback"})]),e("div",Q,[W,n(u,{id:"tel",name:"電話",type:"text",class:p(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入電話",rules:i.isPhone,modelValue:o.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=a=>o.form.user.tel=a)},null,8,["class","rules","modelValue"]),n(m,{name:"電話",class:"invalid-feedback"})]),e("div",X,[Y,n(u,{id:"address",name:"地址",type:"text",class:p(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:o.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=a=>o.form.user.address=a)},null,8,["class","modelValue"]),n(m,{name:"地址",class:"invalid-feedback"})]),e("div",Z,[ee,v(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[5]||(s[5]=a=>o.form.message=a)},null,512),[[g,o.form.message]])]),te]),_:1},512)])],64)}const ae=C(U,[["render",se]]);export{ae as default};
